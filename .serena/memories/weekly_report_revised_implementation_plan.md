# ウィークリーレポート実装計画（見直し版）

## 現状認識

### データ環境
- **articlesテーブル**: 実データが存在（タイトル、URL、いいね数、ブックマーク数）
- **SQLバックアップ**: 具体的な記事データが `__mocks__/production-backup-20250802-044351.sql` に存在
- **現在の実装**: 擬似ランダムによる動的データ生成を実装済み
- **作業手順書**: 実際のSQLデータを使ったモック実装を想定

### 既に実装済みの機能
- サイト別グループ表示UI（TopArticles.tsx）
- 動的週判定システム（擬似ランダム生成）
- DB切り替え対応の枠組み（DATA_SOURCE_CONFIG）
- 新しいデータ構造（SiteRanking、WeeklyReportGrouped）

## 実装方針の選択肢

### SQLモックデータによる仮実装

#### 背景
- **目的**: まずはモックデータで動作確認
- **データソース**: `__mocks__/production-backup-20250802-044351.sql` の実際の記事データ
- **方針**: `fetchWeeklyArticlesFromDB` 関数にSQLデータを仮設定

#### 実装アプローチ
1. **SQLバックアップデータの活用**
   ```typescript
   async function fetchWeeklyArticlesFromDB({ 
     weekRange 
   }: { 
     weekRange: WeekRange 
   }): Promise<WeeklyArticle[]> {
     // 実際のSQLデータを使った固定データを返す
     // 将来的にはDBクエリに置き換える予定
     return getMockDataFromSqlBackup(weekRange);
   }
   ```

2. **複数週対応のモックデータ**
   - SQLバックアップから記事を選定
   - 2025-07-21週、2025-07-14週、2025-07-07週のデータ作成
   - 各週で異なる記事セットを設定

3. **既存機能との統合**
   - 擬似ランダム生成は無効化
   - サイト別グループ表示は既存のまま活用

#### 実装手順
1. **SQLデータ解析**: production-backup-20250802-044351.sql から記事データ抽出
2. **モック関数作成**: `getMockDataFromSqlBackup` 関数実装
3. **週別データ設定**: 3週分のデータセット作成
4. **動作確認**: 実データ風モックでの表示テスト

#### メリット
- **シンプル**: DB接続設定不要
- **確実**: 実際のSQLデータによる確実な表示
- **実データ準拠**: 本物の記事データを使用
- **段階的**: 将来のDB実装への移行が容易

#### 実装後の状態
- モックデータだが実際のSQLデータベース内容
- 複数週のナビゲーション可能
- サイト別グループ表示で視認性向上
- 将来のDB統合準備完了